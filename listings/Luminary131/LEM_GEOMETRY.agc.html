<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta content="text/html;charset=ISO-8859-1" http-equiv="Content-Type">
<title>Assembly listing generated by yaYUL</title>
<style type="text/css">
p.nobreak { white-space:nowrap; }
a { text-decoration:none; }
a:visited { COLOR: #000850; }
</style>
<style type="text/css">
.op{
font-weight: bold;
color: #993300;
}
</style>
<style type="text/css">
.dn{
color: #009900;
}
</style>
<style type="text/css">
.fe{
color: #FF0000;
}
</style>
<style type="text/css">
.in{
color: #FF6600;
}
</style>
<style type="text/css">
.ps{
color: #336600;
}
</style>
<style type="text/css">
.sm{
color: #0000FF;
}
</style>
<style type="text/css">
.wn{
color: #FF9900;
}
</style>
<style type="text/css">
.co{
font-style: italic;
color: #993399;
}
</style>
</head>
<body>
<p class="nobreak">
<span style="font-family: monospace;">
<pre>
<h1>Source Code</h1>
013250,000001:                                                                                                 <span class="co">#  Copyright:     Public domain.</span>
013251,000002:                                                                                                 <span class="co">#  Filename:      LEM_GEOMETRY.agc</span>
013252,000003:                                                                                                 <span class="co">#  Purpose:       A section of Luminary 1C, revision 131.</span>
013253,000004:                                                                                                 <span class="co">#                 It is part of the source code for the Lunar Module's (LM)</span>
013254,000005:                                                                                                 <span class="co">#                 Apollo Guidance Computer (AGC) for Apollo 13 and Apollo 14.</span>
013255,000006:                                                                                                 <span class="co">#                 This file is intended to be a faithful transcription, except</span>
013256,000007:                                                                                                 <span class="co">#                 that the code format has been changed to conform to the</span>
013257,000008:                                                                                                 <span class="co">#                 requirements of the yaYUL assembler rather than the </span>
013258,000009:                                                                                                 <span class="co">#                 original YUL assembler.</span>
013259,000010:                                                                                                 <span class="co">#  Reference:     pp. 327-332 of 1729.pdf.</span>
013260,000011:                                                                                                 <span class="co">#  Contact:       Ron Burkey &lt;info@sandroid.org>.</span>
013261,000012:                                                                                                 <span class="co">#  Website:       www.ibiblio.org/apollo/index.html</span>
013262,000013:                                                                                                 <span class="co">#  Mod history:   05/10/03 RSB.   Began transcribing.</span>
013263,000014:                                                                                                 <span class="co">#                 05/14/05 RSB    Corrected website reference above.</span>
013264,000015: 
013265,000016:                                                                                                 <span class="co">#  Page 327</span>
013266,000017: 23,2041                                          <span class="ps">BANK    </span> 23                                    
013267,000018: 13,2000                                          <span class="ps">SETLOC  </span> <a href="TAGS_FOR_RELATIVE_SETLOC.agc.html#4C454D47454F4D">LEMGEOM</a>                               
013268,000019: 13,2000                                          <span class="ps">BANK    </span>                                       
013269,000020: 
013270,000021: 13,2070  30,2000                                 <span class="ps">SBANK=  </span> <a href="TAGS_FOR_RELATIVE_SETLOC.agc.html#4C4F575355504552">LOWSUPER</a>                              
013271,000022: 13,2070  E5,1642                                 <span class="ps">EBANK=  </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#58534D">XSM</a>                                   
013272,000023: 
013273,000024:                                                                                                 <span class="co">#  THESE TWO ROUTINES COMPUTE THE ACTUAL STATE VECTOR FOR LM,CSM BY ADDING</span>
013274,000025:                                                                                                 <span class="co">#  THE CONIC R,V AND THE DEVIATIONS R,V.  THE STATE VECTORS ARE CONVERTED TO</span>
013275,000026:                                                                                                 <span class="co">#  METERS B-29 AND METERS/CSEC B-7 AND STORED APPROPIRATELY IN RN,VN OR</span>
013276,000027:                                                                                                 <span class="co">#  R-OTHER,V-OTHER FOR DOWNLINK.  THE ROUTINES' NAMES ARE SWITCHED IN THE</span>
013277,000028:                                                                                                 <span class="co">#  OTHER VEHICLE'S COMPUTER.</span>
013278,000029: 
013279,000030:                                                                                                 <span class="co">#  INPUT</span>
013280,000031:                                                                                                 <span class="co">#         STATE VECTOR IN TEMPORARY STORAGE AREA</span>
013281,000032:                                                                                                 <span class="co">#         IF STATE VECTOR IS SCALED POS B27 AND VEL B5</span>
013282,000033:                                                                                                 <span class="co">#                 SET X2 TO +2</span>
013283,000034:                                                                                                 <span class="co">#         IF STATE VECTOR IS SCALED POS B29 AND VEL B7</span>
013284,000035:                                                                                                 <span class="co">#                 SET X2 TO 0</span>
013285,000036: 
013286,000037:                                                                                                 <span class="co">#  OUTPUT</span>
013287,000038:                                                                                                 <span class="co">#         R(T) IN RN, V(T) IN VN, T IN PIPTIME</span>
013288,000039:                                                                                                 <span class="co">#  OR</span>
013289,000040:                                                                                                 <span class="co">#         R(T) IN R-OTHER, V(T) IN V-OTHER        (T IS DEFINED BY T-OTHER)</span>
013290,000041: 
013291,000042: 13,2070                                          <span class="ps">COUNT*  </span> $$/<a href="CONIC_SUBROUTINES.agc.html#47454F4D">GEOM</a>                               
<a name="535644574E32"></a>013292,000043: 13,2070           43414        <span class="sm">SVDWN2  </span>          <span class="in">BOF     </span> <span class="in">RVQ       </span>                            <span class="co">#  SW=1=AVETOMID DOING W-MATRIX INTEG.</span>
013293,000044: 13,2071           04756                                   <a href="FLAGWORD_ASSIGNMENTS.agc.html#4156454D49445357">AVEMIDSW</a>                              
013294,000045: 13,2072           26073                                   +1                                    
013295,000046: 13,2073           53775                          <span class="in">VLOAD   </span> <span class="in">VSL*      </span>                            
013296,000047: 13,2074           01521                                   <a href="ERASABLE_ASSIGNMENTS.agc.html#5444454C544156">TDELTAV</a>                               
013297,000048: 13,2075           57605                                   0          -7,2                       
013298,000049: 13,2076           53655                          <span class="in">VAD     </span> <span class="in">VSL*      </span>                            
013299,000050: 13,2077           01535                                   <a href="ERASABLE_ASSIGNMENTS.agc.html#524356">RCV</a>                                   
013300,000051: 13,2100           57576                                   0,2                                   
013301,000052: 13,2101           25220                          <span class="in">STOVL   </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#524E">RN</a>                                    
013302,000053: 13,2102           01527                                   <a href="ERASABLE_ASSIGNMENTS.agc.html#544E5556">TNUV</a>                                  
013303,000054: 13,2103           53257                          <span class="in">VSL*    </span> <span class="in">VAD       </span>                            
013304,000055: 13,2104           57602                                   0          -4,2                       
013305,000056: 13,2105           01543                                   <a href="ERASABLE_ASSIGNMENTS.agc.html#564356">VCV</a>                                   
013306,000057: 13,2106           77657                          <span class="in">VSL*    </span>                                       
013307,000058: 13,2107           57576                                   0,2                                   
013308,000059: 13,2110           15226                          <span class="in">STODL   </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#564E">VN</a>                                    
013309,000060: 13,2111           01517                                   <a href="ERASABLE_ASSIGNMENTS.agc.html#544554">TET</a>                                   
013310,000061: 13,2112           01234                          <span class="in">STORE   </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#50495054494D45">PIPTIME</a>                               
013311,000062: 13,2113           77616                          <span class="in">RVQ     </span>                                       
013312,000063:                                                                                                 <span class="co">#  Page 328</span>
<a name="535644574E31"></a>013313,000064: 13,2114           53775        <span class="sm">SVDWN1  </span>          <span class="in">VLOAD   </span> <span class="in">VSL*      </span>                            
013314,000065: 13,2115           01521                                   <a href="ERASABLE_ASSIGNMENTS.agc.html#5444454C544156">TDELTAV</a>                               
013315,000066: 13,2116           57605                                   0          -7,2                       
013316,000067: 13,2117           53655                          <span class="in">VAD     </span> <span class="in">VSL*      </span>                            
013317,000068: 13,2120           01535                                   <a href="ERASABLE_ASSIGNMENTS.agc.html#524356">RCV</a>                                   
013318,000069: 13,2121           57576                                   0,2                                   
013319,000070: 13,2122           25720                          <span class="in">STOVL   </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#522D4F54484552">R-OTHER</a>                               
013320,000071: 13,2123           01527                                   <a href="ERASABLE_ASSIGNMENTS.agc.html#544E5556">TNUV</a>                                  
013321,000072: 13,2124           53257                          <span class="in">VSL*    </span> <span class="in">VAD       </span>                            
013322,000073: 13,2125           57602                                   0          -4,2                       
013323,000074: 13,2126           01543                                   <a href="ERASABLE_ASSIGNMENTS.agc.html#564356">VCV</a>                                   
013324,000075: 13,2127           77657                          <span class="in">VSL*    </span>                                       
013325,000076: 13,2130           57576                                   0,2                                   
013326,000077: 13,2131           01726                          <span class="in">STORE   </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#562D4F54484552">V-OTHER</a>                               
013327,000078: 13,2132           77616                          <span class="in">RVQ     </span>                                       
013328,000079: 
013329,000080:                                                                                                 <span class="co">#  Page 329</span>
013330,000081:                                                                                                 <span class="co">#  THE FOLLOWING ROUTINE TAKES A HALF UNIT TARGET VECTOR REFERRED TO NAV BASE COORDINATES AND FINDS BOTH</span>
013331,000082:                                                                                                 <span class="co">#  GIMBAL ORIENTATIONS AT WHICH THE RR MIGHT SIGHT THE TARGET.  THE GIMBAL ANGLES CORRESPONDING TO THE PRESENT MODE</span>
013332,000083:                                                                                                 <span class="co">#  ARE LEFT IN MODEA AND THOSE WHICH WOULD BE USED AFTER A REMODE IN MODEB.  THIS ROUTINE ASSUMES MODE 1 IS TRUNNION</span>
013333,000084:                                                                                                 <span class="co">#  ANGLE LESS THAN 90 DEGS IN ABS VALUE WITH ARBITRARY SHAFT, WITH A CORRESPONDING DEFINITION FOR MODE 2.  MODE</span>
013334,000085:                                                                                                 <span class="co">#  SELECTION AND LIMIT CHECKING ARE DONE ELSEWHERE.</span>
013335,000086: 
013336,000087:                                                                                                 <span class="co">#  THE MODE 1 CONFIGURATION IS CALCULATED FROM THE VECTOR AND THEN MODE 2 IS FOUND USING THE RELATIONS</span>
013337,000088: 
013338,000089:                                                                                                 <span class="co">#         S(2) = 180 + S(1)</span>
013339,000090:                                                                                                 <span class="co">#         T(2) = 180 - T(1)</span>
013340,000091: 
013341,000092:                                                                                                 <span class="co">#  THE VECTOR ARRIVES IN MPAC WHERE TRG*SMNG OR *SMNB* WILL HAVE LEFT IT.</span>
013342,000093: 
<a name="5252414E474C4553"></a>013343,000094: 13,2133           00041        <span class="sm">RRANGLES</span>          <span class="in">STORE   </span> 32D                                   
013344,000095: 13,2134           57545                          <span class="in">DLOAD   </span> <span class="in">DCOMP     </span>                            <span class="co">#  SINCE WE WILL FIND THE MODE 1 SHAFT</span>
013345,000096: 13,2135           00043                                   34D                                   <span class="co">#  ANGLE LATER, WE CAN FIND THE MODE 1</span>
013346,000097: 13,2136           67401                          <span class="in">SETPD   </span> <span class="in">ASIN      </span>                            <span class="co">#  TRUNNION BY SIMPLY TAKING THE ARCSIN OF</span>
013347,000098: 13,2137           00001                                   0                                     <span class="co">#  THE Y COMPONENT, THE ASIN GIVIN AN</span>
013348,000099: 13,2140           44206                          <span class="in">PUSH    </span> <span class="in">BDSU      </span>                            <span class="co">#  ANSWER WHOSE ABS VAL IS LESS THAN 90 DEG.</span>
013349,000100: 13,2141           24005                                   <a href="TAGS_FOR_RELATIVE_SETLOC.agc.html#4C4F445048414C46">LODPHALF</a>                              
013350,000101: 13,2142           14005                          <span class="in">STODL   </span> 4                                     <span class="co">#  MODE 2 TRUNNION TO 4.</span>
013351,000102: 13,2143           24007                                   <a href="TAGS_FOR_RELATIVE_SETLOC.agc.html#4C4F365A45524F53">LO6ZEROS</a>                              
013352,000103: 13,2144           24043                          <span class="in">STOVL   </span> 34D                                   <span class="co">#  UNIT THE PROJECTION OF THE VECTOR</span>
013353,000104: 13,2145           00041                                   32D                                   <span class="co">#         IN THE X-Z PLANE</span>
013354,000105: 13,2146           41056                          <span class="in">UNIT    </span> <span class="in">BOVB      </span>                            <span class="co">#  IF OVERFLOW, TARGET VECTOR IS ALONG Y</span>
013355,000106: 13,2147           52432                                   <a href="P20-P25.agc.html#4C554E4445534348">LUNDESCH</a>                              <span class="co">#  CALL FOR MANEUVER UNLESS ON LUNAR SURF</span>
013356,000107: 13,2150           14041                          <span class="in">STODL   </span> 32D                                   <span class="co">#  PROJECTION VECTOR.</span>
013357,000108: 13,2151           00041                                   32D                                   
013358,000109: 13,2152           44142                          <span class="in">SR1     </span> <span class="in">STQ       </span>                            
013359,000110: 13,2153           00051                                   <a href="ERASABLE_ASSIGNMENTS.agc.html#5332">S2</a>                                    
013360,000111: 13,2154           14023                          <span class="in">STODL   </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#53494E5448">SINTH</a>                                 <span class="co">#  USE ARCTRIG SINCE SHAFT COULD BE ARG.</span>
013361,000112: 13,2155           00045                                   36D                                   
013362,000113: 13,2156           77742                          <span class="in">SR1     </span>                                       
013363,000114: 13,2157           34021                          <span class="in">STCALL  </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#434F535448">COSTH</a>                                 
013364,000115: 13,2160           47322                                   <a href="INFLIGHT_ALIGNMENT_ROUTINES.agc.html#41524354524947">ARCTRIG</a>                               
013365,000116:                                                                                                 <span class="co">#  Page 331</span>
013366,000117: 13,2161           43206                          <span class="in">PUSH    </span> <span class="in">DAD       </span>                            <span class="co">#  MODE 1 SHAFT TO 2.</span>
013367,000118: 13,2162           24005                                   <a href="TAGS_FOR_RELATIVE_SETLOC.agc.html#4C4F445048414C46">LODPHALF</a>                              
013368,000119: 13,2163           24007                          <span class="in">STOVL   </span> 6                                     
013369,000120: 13,2164           00005                                   4                                     
013370,000121: 13,2165           77634                          <span class="in">RTB     </span>                                       <span class="co">#  FIND MODE 2 CDU ANGLES.</span>
013371,000122: 13,2166           21636                                   <a href="RTB_OP_CODES.agc.html#32563153544F3253">2V1STO2S</a>                              
013372,000123: 13,2167           25111                          <span class="in">STOVL   </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4D4F444542">MODEB</a>                                 
013373,000124: 13,2170           00001                                   0                                     
013374,000125: 13,2171           77634                          <span class="in">RTB     </span>                                       <span class="co">#  MODE 1 ANGLES TO MODE A.</span>
013375,000126: 13,2172           21636                                   <a href="RTB_OP_CODES.agc.html#32563153544F3253">2V1STO2S</a>                              
013376,000127: 13,2173           01107                          <span class="in">STORE   </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4D4F444541">MODEA</a>                                 
013377,000128: 13,2174           77776                          <span class="in">EXIT    </span>                                       
013378,000129: 
013379,000130: 13,2175           40110                          <span class="op">CS      </span> <a href="FLAGWORD_ASSIGNMENTS.agc.html#5241444D4F444553">RADMODES</a>                              <span class="co">#  SWAP MODEA AND MODEB IF RR IN MODE 2.</span>
013380,000131: 13,2176           74740                          <span class="op">MASK    </span> <a href="FLAGWORD_ASSIGNMENTS.agc.html#414E54454E424954">ANTENBIT</a>                              
013381,000132: 13,2177           10000                          <span class="op">CCS     </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#41">A</a>                                     
013382,000133: 13,2200           12204                          <span class="op">TCF     </span> +4                                    
013383,000134: 
013384,000135: 13,2201           53107                          <span class="op">DXCH    </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4D4F444541">MODEA</a>                                 
013385,000136: 13,2202           53111                          <span class="op">DXCH    </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4D4F444542">MODEB</a>                                 
013386,000137: 13,2203           53107                          <span class="op">DXCH    </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4D4F444541">MODEA</a>                                 
013387,000138: 
013388,000139: 13,2204           06042                          <span class="op">TC      </span> <a href="INTERPRETER.agc.html#494E5450524554">INTPRET</a>                               
013389,000140: 13,2205           77650                          <span class="in">GOTO    </span>                                       
013390,000141: 13,2206           00051                                   <a href="ERASABLE_ASSIGNMENTS.agc.html#5332">S2</a>                                    
013391,000142:                                                                                                 <span class="co">#  Page 331</span>
013392,000143:                                                                                                 <span class="co">#  GIVEN RR TRUNNION AND SHAFT (T,S) IN TANGNB,+1, FIND THE ASSOCIATED</span>
013393,000144:                                                                                                 <span class="co">#  LINE OF SIGHT IN NAV BASE AXES.  THE HALF UNIT VECTOR, .5(SIN(S)COS(T),</span>
013394,000145:                                                                                                 <span class="co">#  -SIN(T),COS(S)COS(T)) IS LEFT IN MPAC AND 32D.</span>
013395,000146: 
013396,000147: 23,2000                                          <span class="ps">SETLOC  </span> <a href="TAGS_FOR_RELATIVE_SETLOC.agc.html#494E464C49474854">INFLIGHT</a>                              
013397,000148: 23,2000                                          <span class="ps">BANK    </span>                                       
013398,000149: 
013399,000150: 23,2041                                          <span class="ps">COUNT*  </span> $$/<a href="CONIC_SUBROUTINES.agc.html#47454F4D">GEOM</a>                               
013400,000151: 
<a name="52524E42"></a>013401,000152: 23,2041           47135        <span class="sm">RRNB    </span>          <span class="in">SLOAD   </span> <span class="in">RTB       </span>                            
013402,000153: 23,2042           03753                                   <a href="ERASABLE_ASSIGNMENTS.agc.html#54414E474E42">TANGNB</a>                                
013403,000154: 23,2043           21577                                   <a href="RTB_OP_CODES.agc.html#4344554C4F474943">CDULOGIC</a>                              
013404,000155: 23,2044           41401                          <span class="in">SETPD   </span> <span class="in">PUSH      </span>                            <span class="co">#  TRUNNION ANGLE TO 0</span>
013405,000156: 23,2045           00001                                   0                                     
013406,000157: 23,2046           57556                          <span class="in">SIN     </span> <span class="in">DCOMP     </span>                            
013407,000158: 23,2047           14043                          <span class="in">STODL   </span> 34D                                   <span class="co">#  Y COMPONENT</span>
013408,000159: 
013409,000160: 23,2050           41546                          <span class="in">COS     </span> <span class="in">PUSH      </span>                            <span class="co">#  .5 COS(T) TO 0</span>
013410,000161: 23,2051           47135                          <span class="in">SLOAD   </span> <span class="in">RTB       </span>                            
013411,000162: 23,2052           03754                                   <a href="ERASABLE_ASSIGNMENTS.agc.html#54414E474E42">TANGNB</a>     +1                         
013412,000163: 23,2053           21577                                   <a href="RTB_OP_CODES.agc.html#4344554C4F474943">CDULOGIC</a>                              
<a name="52524E4231"></a>013413,000164: 23,2054           71406        <span class="sm">RRNB1   </span>          <span class="in">PUSH    </span> <span class="in">COS       </span>                            <span class="co">#  SHAFT ANGLE TO 2</span>
013414,000165: 23,2055           72405                          <span class="in">DMP     </span> <span class="in">SL1       </span>                            
013415,000166: 23,2056           00001                                   0                                     
013416,000167: 23,2057           14045                          <span class="in">STODL   </span> 36D                                   <span class="co">#  Z COMPONENT</span>
013417,000168: 
013418,000169: 23,2060           41356                          <span class="in">SIN     </span> <span class="in">DMP       </span>                            
013419,000170: 23,2061           77752                          <span class="in">SL1     </span>                                       
013420,000171: 23,2062           24041                          <span class="in">STOVL   </span> 32D                                   
013421,000172: 23,2063           00041                                   32D                                   
013422,000173: 23,2064           77616                          <span class="in">RVQ     </span>                                       
013423,000174: 
013424,000175:                                                                                                 <span class="co">#  THIS ENTRY TO RRNB REQUIRES THE TRUNNION AND SHAFT ANGLES IN MPAC AND MPAC +1 RESPECTIVELY</span>
013425,000176: 
<a name="52524E424D504143"></a>013426,000177: 23,2065           14025        <span class="sm">RRNBMPAC</span>          <span class="in">STODL   </span> 20D                                   <span class="co">#  SAVE SHAFT CDU IN 21.</span>
013427,000178: 23,2066           00155                                   <a href="ERASABLE_ASSIGNMENTS.agc.html#4D504143">MPAC</a>                                  <span class="co">#  SET MODE TO DP.  (THE PRECEEDING STORE</span>
013428,000179:                                                                                                 <span class="co">#  MAY BE DP, TP OR VECTOR.)</span>
013429,000180: 23,2067           40234                          <span class="in">RTB     </span> <span class="in">SETPD     </span>                            
013430,000181: 23,2070           21577                                   <a href="RTB_OP_CODES.agc.html#4344554C4F474943">CDULOGIC</a>                              
013431,000182: 23,2071           00001                                   0                                     
013432,000183: 23,2072           73406                          <span class="in">PUSH    </span> <span class="in">SIN       </span>                            <span class="co">#  TRUNNION ANGLE TO 0</span>
013433,000184: 23,2073           77676                          <span class="in">DCOMP   </span>                                       
013434,000185: 23,2074           14043                          <span class="in">STODL   </span> 34D                                   <span class="co">#  Y COMPONENT</span>
013435,000186: 23,2075           41546                          <span class="in">COS     </span> <span class="in">PUSH      </span>                            <span class="co">#  .5COS(T) TO 0</span>
013436,000187: 23,2076           47135                          <span class="in">SLOAD   </span> <span class="in">RTB       </span>                            <span class="co">#  PICK UP CDU'S.</span>
013437,000188: 23,2077           00026                                   21D                                   
013438,000189: 23,2100           21577                                   <a href="RTB_OP_CODES.agc.html#4344554C4F474943">CDULOGIC</a>                              
013439,000190: 23,2101           77650                          <span class="in">GOTO    </span>                                       
013440,000191: 23,2102           46054                                   <a href="#52524E4231">RRNB1</a>                                 
013441,000192:                                                                                                 <span class="co">#  Page 332</span>
013442,000193:                                                                                                 <span class="co">#  (This page has nothing on it.)</span>
013443,000194: 
013444,000195: 

End of include-file LEM_GEOMETRY.agc.  Parent file is <a href="MAIN.agc.html">MAIN.agc</a>
</pre>
</span>
</p>
</body>
</html>
